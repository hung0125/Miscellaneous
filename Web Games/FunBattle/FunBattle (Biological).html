<html>
    <style>
        h1
        {
            text-align: center;
        }
        #inp
        {
            margin: auto;
            width: 50%;
            padding: 10px;
        }
        input
        {
            width: 40%;
        }
        button
        {
            width: 15%;
        }
        #charStat
        {
            margin: auto;
            width: 50%;
            border: 3px solid rebeccapurple;
            padding: 10px;
            height: 50px;
        }
        #HPA, #HPB
        {
            width: 40%;
            height: 100%;
        }
        #HPA
        {
            float: left;
        }
        #HPB
        {
            float: right;
        }
        #main
        {
            margin: auto;
            width: 50%;
            border: 3px solid red;
            padding: 10px;
        }

    </style>
    <body>
        <h1>FunBattle! (Biological Edition)</h1>
        <div id="inp">
            <input id="charA" placeholder="Name of character A"/>
            <input id="charB" placeholder="Name of character B"/>
            <button id="Fight" onclick="fight()">Fight</button>
            <br><br>
            <input id="dmgFrom" placeholder="Default (from): 0"/> -
            <input id="dmgTo" placeholder="Default (to): 100"/>
            <button id="setRange" onclick="setRange()">Set Damage Range</button>
        </div>
        <div id="charStat">
            <div id="HPA"><b style="color: green;">??</b>'s HP:1000</div>
            ||
            <div id="HPB"><b style="color: purple;">??</b>'s HP:1000</h5></div>
        </div>
        <div id="main"></div>
    </body>
    <script>
        //Define list of attack descriptions
        attackIllustrations = [
            "{atk} stepped on {rec}'s feet. Dealt {DMG} damage.<br>",
            "{atk} knocked {rec}'s head with fist. Dealt {DMG} damage.<br>",
            "{atk} knocked {rec}'s head with hammer. Dealt {DMG} damage.<br>",
            "{atk} punched {rec}'s face. Dealt {DMG} damage.<br>",
            "{atk} called police, police shot {rec}. Dealt {DMG} damage.<br>",
            "{atk} poured hot water on {rec}. Dealt {DMG} damage.<br>",
            "{atk} raised a hard calculus problem to {rec}, {rec} suffered from headache. Dealt {DMG} damage.<br>"
        ];
        //Define HP
        hpA = 1000;  
        hpB = 1000;

        //Define damage range
        dmgFrom = 0;
        dmgTo = 100;

        //Set damage range from user input
        function setRange()
        {
            dmgFrom = document.getElementById("dmgFrom").value*1;
            dmgTo = document.getElementById("dmgTo").value*1;

            alert(`Current damage range: ${dmgFrom} - ${dmgTo}`);
        }

        //Fight launches from button click
        function fight()
        {
            
            charA = document.getElementById("charA").value;
            charB = document.getElementById("charB").value;
            
            if(charA == '' || charB == '')
            {
                document.getElementById("main").innerText = "one or both characters have no name, fight could not be started.\n";
            }else
            {
                //Disable buttons
                document.getElementById("Fight").disabled = true;
                document.getElementById("setRange").disabled = true;
                
                //Display who has joined the fight
                document.getElementById("main").innerHTML = `<b style="color: green;">${charA}</b> has joined the fight.<br><b style="color: purple;">${charB}</b> has joined the fight.<br>`;
                
                //Display initial statistics
                document.getElementById("HPA").innerHTML = `<b style="color: green;">${charA}</b>'s HP: 1000`;
                document.getElementById("HPB").innerHTML = `<b style="color: purple;">${charB}</b>'s HP: 1000`;
                
                //Initial initial statistics for each character
                hpA = 1000;
                hpB = 1000;
                
                //Fight every 2 seconds (2000ms -> 2s)
                doMain = setInterval(action, 2000);

            }
        }

        //Main fight
        function action()
        {
            //Keep fighting till one is down
            if(hpA > 0 && hpB > 0)
            {
                updateHP();
            }else
            {
                //Display the summarization of battle
                if(hpA <= 0)
                    document.getElementById("main").innerHTML += `The battle is over. <b style="color: purple;">${charB}</b> defeated <b style="color: green;">${charA}</b>!`;
                else
                    document.getElementById("main").innerHTML += `The battle is over. <b style="color: green;">${charA}</b> defeated <b style="color: purple;">${charB}</b>!`;

                //Enable buttons
                document.getElementById("Fight").disabled = false;
                document.getElementById("setRange").disabled = false;
                clearInterval(doMain);
            }
        }

        //Update HP for each character
        function updateHP()
        {
            //Define random damage
            damage = Math.floor(Math.random() * (dmgTo + 1 - dmgFrom) + dmgFrom);

            //Define who does the damage & who takes the damage
            attackRole = Math.floor(Math.random() * 2);

            if(attackRole == 0)
            {
                //attacker = charA
                //receiver = charB
                damage = Math.min(damage, hpB);

                //Display attack descriptions
                document.getElementById("main").innerHTML += attackIllustrations[Math.floor(Math.random() * attackIllustrations.length)]
                    .replaceAll("{atk}",`<b style='color: green;'>${charA}</b>`)
                    .replaceAll("{rec}", `<b style='color: purple;'>${charB}</b>`)
                    .replace("{DMG}", `<b style='color: red;'>${damage}</b>`);
                
                //Apply the damage change
                hpB -= damage;

                //Red text effect
                document.getElementById("HPB").innerHTML = `<b style="color: purple;">${charB}</b>'s HP: <nobr style="color:red">${hpB}</nobr>`;
                setTimeout(function(){
                    document.getElementById("HPB").innerHTML = `<b style="color: purple;">${charB}</b>'s HP: ${hpB}`;
                }, 500);
            }
            else
            {
                //attacker = charB
                //receiver = charA
                damage = Math.min(damage, hpA);

                //Display attack descriptions
                document.getElementById("main").innerHTML += attackIllustrations[Math.floor(Math.random() * attackIllustrations.length)]
                    .replaceAll("{atk}",`<b style='color: purple;'>${charB}</b>`)
                    .replaceAll("{rec}", `<b style='color: green;'>${charA}</b>`)
                    .replace("{DMG}", `<b style='color: red;'>${damage}</b>`);

                //Apply the damage change
                hpA -= damage;

                //Red text effect
                document.getElementById("HPA").innerHTML = `<b style="color: green;">${charA}</b>'s HP: <nobr style="color:red">${hpA}</nobr>`;
                setTimeout(function(){
                    document.getElementById("HPA").innerHTML = `<b style="color: green;">${charA}</b>'s HP: ${hpA}`;
                }, 500);
            }
        }
    </script>
</html>
